{% extends 'core/base.html' %}
{% load static humanize %}

{% block title %}All Minnesota — All in this together.{% endblock %}

{% block content %}
<!-- HERO: full-width dark green, logo, headline, Donate button -->
<section class="hero-section py-5">
    <div class="container py-5 text-center text-white">
        <img src="{% static 'core/images/logo.png' %}" alt="All Minnesota" class="hero-logo mb-4" height="120" width="auto">
        <h1 class="display-3 fw-bold mb-3">All Minnesota</h1>
        <p class="lead mb-4">All in this together.</p>
        <p class="hero-statement mb-4 mx-auto" style="max-width: 600px;">
            Supporting indigenous-led community meal distribution across Minnesota.
            Your support helps fund meals and connect volunteers with those who need them most.
        </p>
        <a href="#DONATE_PLACEHOLDER" target="_blank" class="btn btn-gold btn-lg px-4">Donate Now</a>
    </div>
</section>

<!-- PROGRESS BAR: current vs target, stat cards -->
{% if goal %}
<section class="py-5 bg-light-custom">
    <div class="container">
        <h2 class="text-center text-dark mb-4">Our Progress</h2>
        <div class="progress mb-4" style="height: 28px;">
            <div class="progress-bar bg-gold" role="progressbar" style="width: {{ progress_percent }}%;" aria-valuenow="{{ progress_percent }}" aria-valuemin="0" aria-valuemax="100">{{ progress_percent }}%</div>
        </div>
        <div class="row g-4 text-center">
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <h5 class="text-primary-green">Dollars Raised</h5>
                        <p class="fs-4 mb-0 fw-bold">${{ goal.current_amount|floatformat:0|intcomma }}</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <h5 class="text-primary-green">Meals Funded</h5>
                        <p class="fs-4 mb-0 fw-bold">{{ goal.meals_funded|intcomma }}</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm">
                    <div class="card-body">
                        <h5 class="text-primary-green">Volunteers</h5>
                        <p class="fs-4 mb-0 fw-bold">{{ goal.volunteers_count|intcomma }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- ABOUT SNIPPET: 3-sentence teaser → /about/ -->
<section class="py-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-8 mx-auto text-center">
                <h2 class="text-primary-green mb-3">Our Story</h2>
                <p class="text-dark lead">
                    All Minnesota is an indigenous-led initiative bringing community meals to those who need them.
                    We partner with Sean Sherman's Indigenous Food Lab and tribal nations across the state.
                    Together we're building a more connected, nourished Minnesota.
                </p>
                <a href="{% url 'core:about' %}" class="btn btn-outline-primary-green">Learn More</a>
            </div>
        </div>
    </div>
</section>

<!-- UPCOMING EVENTS: next 3 events, Get Tickets (external) -->
{% if upcoming_events %}
<section class="py-5 bg-light-custom">
    <div class="container">
        <h2 class="text-center text-dark mb-4">Upcoming Events</h2>
        <div class="row g-4">
            {% for event in upcoming_events %}
            <div class="col-md-4">
                <div class="card h-100 border-0 shadow-sm overflow-hidden">
                    {% if event.image %}
                    <img src="{{ event.image.url }}" class="card-img-top" alt="{{ event.title }}" style="height: 180px; object-fit: cover;">
                    {% else %}
                    <div class="card-img-top bg-secondary d-flex align-items-center justify-content-center" style="height: 180px;">
                        <i class="fas fa-calendar-alt fa-3x text-white-50"></i>
                    </div>
                    {% endif %}
                    <div class="card-body">
                        <h5 class="card-title text-primary-green">{{ event.title }}</h5>
                        <p class="text-muted small mb-1">{{ event.date|date:"M j, Y" }} — {{ event.venue_name }}</p>
                        {% if event.ticket_url %}
                        <a href="{{ event.ticket_url }}" target="_blank" rel="noopener" class="btn btn-gold btn-sm mt-2">Get Tickets</a>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="text-center mt-3">
            <a href="{% url 'core:events_list' %}" class="btn btn-outline-primary-green">View All Events</a>
        </div>
    </div>
</section>
{% endif %}

<!-- CTA BAND: Sign up to volunteer → /volunteer/ -->
<section class="py-5 cta-band">
    <div class="container text-center text-white">
        <h2 class="mb-3">Ready to help?</h2>
        <p class="lead mb-4">Sign up to volunteer and join our community.</p>
        <a href="{% url 'core:volunteer' %}" class="btn btn-gold btn-lg">Sign Up to Volunteer</a>
    </div>
</section>
{% endblock %}
